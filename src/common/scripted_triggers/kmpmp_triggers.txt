# root - country
# STATE_REGION - <s:STATE_***>
owns_or_has_subject_entire_state_region = {
    $STATE_REGION$ = {
        custom_tooltip = {
            text = owns_or_has_subject_entire_state_region_tooltip
            any_scope_state = {
                OR = {
                    owner = root
                    owner = {
                        is_subject_of = root
                    }
                }
                count = all
            }
        }
    }
}

# root - country
# STATE_REGION - <s:STATE_***>
owns_or_has_subject_entire_state_region_and_is_incorporated = {
    $STATE_REGION$ = {
        custom_tooltip = {
            text = owns_or_has_subject_entire_state_region_and_is_incorporated_tooltip
            any_scope_state = {
                OR = {
                    owner = root
                    owner = {
                        is_subject_of = root
                    }
                }
                is_incorporated = yes
                count = all
            }
        }
    }
}

# root - country
# this - STATE_REGION
state_region_owned = {
    custom_tooltip = {
        text = state_region_owned_tooltip
        any_scope_state = {
            count = all
            owner = ROOT
        }
    }
}

# root - country
# STATE_REGION - <STATE_***>
state_region_owned_and_incorporated = {
    s:$STATE_REGION$ = {
        save_temporary_scope_as = state_region_to_check
    }
    custom_tooltip = {
        text = state_region_owned_and_incorporated_tooltip
        owns_entire_state_region = $STATE_REGION$
        s:$STATE_REGION$ = {
            any_scope_state = {
                count = all
                is_incorporated = yes
            }
        }
    }
}

# root - STATE_REGION
# we suggest this is an island if:
# adjacent land state regions < 2
# adjacent sea state region > 0
is_island = {
    is_state_region_land = yes
    any_scope_state = {
        is_sea_adjacent = yes
    }
    # - this is state not state_region - may fail
    # - fails for some state regions which aren't islands because they have just one adjacent land region
    # - neighbouring states returns only states which aren't blocked by impassable land, 
    #   so it fails for different state regions which have many impassable land around.
    # known false positives:
    #  Chukotka
    # known fails:
    #  none
    any_neighbouring_state = {
        count < 2
    }
}

# root - country
kmpmp_is_chinese_country = {
    OR = {
        any_primary_culture = {
            has_discrimination_trait = han_chinese
        }
        country_has_primary_culture = cu:yi
        country_has_primary_culture = cu:manchu
    }
    OR = {
        capital.region = sr:region_north_china
        capital.region = sr:region_south_china
        capital.region = sr:region_manchuria
        capital.region = sr:region_central_asia
        capital.region = sr:region_himalayas
    }
}

# root - war to check war exhaustion against scope:target_country
# scope:target_country - comparison country
# TARGET_VALUE - comparison value
kmpmp_war_support_lower_or_equal_than = {
    save_temporary_scope_value_as = {
        name = target_value
        value = $TARGET_VALUE$
    }
    custom_tooltip = {
        text = kmpmp_war_support_lower_or_equal_than_tt

        has_war_support = {
            target = scope:target_country
            value <= scope:target_value
        }
    }
}
