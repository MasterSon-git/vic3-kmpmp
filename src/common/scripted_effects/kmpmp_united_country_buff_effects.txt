kmpmp_update_united_country_buff = {
    if = {
        limit = {
            c:IBE ?= ROOT
        }
        kmpmp_update_united_country_buff_ibe = yes
    }
    if = {
        limit = {
            c:UNL ?= ROOT
        }
        kmpmp_update_united_country_buff_unl = yes
    }
    if = {
        limit = {
            c:P01 ?= ROOT
        }
        kmpmp_update_united_country_buff_p01 = yes
    }
    if = {
        limit = {
            c:SCA ?= ROOT
        }
        kmpmp_update_united_country_buff_sca = yes
    }
}

kmpmp_update_united_country_buff_ibe = {
    if = {
        limit = {
            kmpmp_owns_all_ibe_states = yes
        }
        if = {
            limit = {
                NOT = {
                    has_modifier = kmpmp_united_iberia
                }
            }
            add_modifier = {
                name = kmpmp_united_iberia
            }
        }
    }
    else_if = {
        limit = {
            has_modifier = kmpmp_united_iberia
        }
        remove_modifier = kmpmp_united_iberia
    }
}

kmpmp_update_united_country_buff_unl = {
    if = {
        limit = {
            kmpmp_owns_all_unl_states = yes
        }
        if = {
            limit = {
                NOT = {
                    has_modifier = kmpmp_united_netherlands
                }
            }
            add_modifier = {
                name = kmpmp_united_netherlands
            }
        }
    }
    else_if = {
        limit = {
            has_modifier = kmpmp_united_netherlands
        }
        remove_modifier = kmpmp_united_netherlands
    }
}

kmpmp_update_united_country_buff_p01 = {
    if = {
        limit = {
            kmpmp_owns_all_p01_states = yes
        }
        if = {
            limit = {
                NOT = {
                    has_modifier = kmpmp_parthian_empire
                }
            }
            add_modifier = {
                name = kmpmp_parthian_empire
            }
        }
    }
    else_if = {
        limit = {
            has_modifier = kmpmp_parthian_empire
        }
        remove_modifier = kmpmp_parthian_empire
    }
}

kmpmp_update_united_country_buff_sca = {
    if = {
        limit = {
            kmpmp_owns_70percent_sca_states = yes

            OR = { # copied from kmpmp_00_major_formables
                owns_entire_state_region = STATE_ZEALAND
    
                AND = {
                    owns_entire_state_region = STATE_ALAND
                    owns_entire_state_region = STATE_UUSIMAA
                    owns_entire_state_region = STATE_OSTROBOTHNIA
                    owns_entire_state_region = STATE_OULU
                }
    
                c:FIN ?= {
                    is_direct_subject_of = ROOT
                }
            }
        }
        if = {
            limit = {
                NOT = {
                    has_modifier = kmpmp_lion_of_the_north
                }
            }
            add_modifier = {
                name = kmpmp_lion_of_the_north
            }
        }
    }
    else_if = {
        limit = {
            has_modifier = kmpmp_lion_of_the_north
        }
        remove_modifier = kmpmp_lion_of_the_north
    }
}