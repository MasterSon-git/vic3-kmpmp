formation.5 = {
	type = country_event
	placement = ROOT

	title = formation.5.t
	desc = formation.5.d
	flavor = {
		first_valid = {
			triggered_desc = {
				desc = formation.5.f
				trigger = {
					has_law = law_type:law_monarchy
				}
			}
			triggered_desc = {
				desc = formation.5.f2
				trigger = {
					always = yes
				}
			}
		}
	}
	event_image = {
		video = "unspecific_signed_contract"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/waving_flag.dds"

	duration = 3

	trigger = {
		c:IBE ?= THIS
		NOT = { has_global_variable = has_formed_ibe }
	}

	immediate = {
		set_global_variable = has_formed_ibe
		save_scope_as = formation_country
		every_country = {
			limit = {
				has_diplomatic_relevance = ROOT
			}
			post_notification = unification_notification_ibe
		}
	}

	option = {
		name = formation.5.a
		default_option = yes
		add_modifier = {
			name = unification_prestige
			months = very_long_modifier_time
		}
		add_modifier = {
			name = kmpmp_united_iberia
		}
		if = {
			limit = {
				NOT = { owns_entire_state_region = STATE_SICILY }
			}
			s:STATE_SICILY = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				NOT = { owns_entire_state_region = STATE_SARDINIA }
			}
			s:STATE_SARDINIA = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				NOT = { owns_entire_state_region = STATE_CORSICA}
			}
			s:STATE_CORSICA = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				NOT = { owns_entire_state_region = STATE_AL_RIF}
			}
			s:STATE_AL_RIF = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				NOT = { owns_entire_state_region = STATE_FEZ }
			}
			s:STATE_FEZ = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				NOT = { owns_entire_state_region = STATE_MARRAKECH}
			}
			s:STATE_MARRAKECH = {
				add_claim = ROOT
			}
		}
		if = {
			limit = {
				NOT = { owns_entire_state_region = STATE_INNER_MOROCCO}
			}
			s:STATE_INNER_MOROCCO = {
				add_claim = ROOT
			}
		}



		unification_claims_effect = yes
		ai_chance = {
			factor = 1
		}
	}
}